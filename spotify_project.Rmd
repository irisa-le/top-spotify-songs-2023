---
title: "Top Spotify Songs of 2023"
author: "Irisa Le"
date: "2025-07-19"
output: html_document
---

## Load libraries
```{r}
library(ggplot2)
library(dplyr)
```

## Load data
```{r}
songs <- read.csv("spotify-2023.csv", encoding = "UTF-8")
```

```{r}
dim(songs)
```

```{r}
View(songs)
```

```{r}
# clean data with ._ and artist.s.name -> artist name
colnames(songs)
```

### Data cleaning
#### Rename unclear columns
```{r}
songs <- rename(songs, artist_name = artist.s._name,
                danceability_pct = danceability_., valence_pct = valence_., energy_pct = energy_.,          
                acousticness_pct = acousticness_., instrumentalness_pct = instrumentalness_., 
                liveness_pct = liveness_., speechiness_pct = speechiness_.)
```

#### Drop columns with platform-specific data excluding Spotify
```{r}
songs <- songs %>%
  select(-in_apple_charts, -in_deezer_charts, -in_shazam_charts,
         -in_apple_playlists, -in_deezer_playlists)
```

#### Look at existing columns
```{r}
colnames(songs)
```

```{r}
# Top 6 rows
head(songs)
```

```{r}
# Last 6 rows
tail(songs)
```

```{r}
# clean data: make streams of integer class,
summary(songs)
```

#### Check for missing values (NA) or empty character strings
```{r}
# check if any numeric column have NA values
colSums(is.na(songs))
```

```{r}
# check for blank character values ""
# 'key'
sapply(songs, function(col) any(col == "", na.rm = TRUE))
```

```{r}
# set "" to NA
# check how many NAs there are now
songs[songs == ""] <- NA
colSums(is.na(songs))
```

```{r}
# convert 'streams' column to be of numeric class, and keep NAs
songs <- songs %>%
  mutate(streams = as.numeric(streams))
```

#### Check which rows introduced NA values
```{r}
which(is.na(songs$streams))
```

#### Drop row 575 and row 124
```{r}
songs <- songs %>%
  slice(-c(124, 575))
```

```{r}
dim(songs)
```

#### Export data for manual cleaning (encoding, missing key values)
```{r}
write.csv(songs, "spotify-2023-partially-cleaned.csv", row.names = FALSE)
```

### Exploratory Data Analysis
```{r}
summary(artist_song_sum)
```

```{r}
artist_song_sum <- songs %>%
  group_by(artist_name) %>%
  summarise(total_songs = n()) %>%
  arrange(desc(total_songs))

artist_song_num_barplot <- ggplot(data=artist_song_sum, aes(x=artist_name, y=total_songs)) +
                            geom_bar(stat="identity") +
                            coord_flip()

artist_song_num_barplot
```

### Multiple Linear Regression: Streams
```{r}
# remove rows with NAs for multi-linear regression using streams
songs_no_nas <- na.rm()
```

### Multiple Linear Regression: Placing


```{r}
songs$artist_name
```

```{r}
songs %>%
  filter(grepl("[^A-Za-z0-9\\s]", artist_name))
```


















